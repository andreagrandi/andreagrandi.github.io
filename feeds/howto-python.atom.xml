<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Andrea Grandi - HowTo, Python</title><link href="https://www.andreagrandi.co.uk/" rel="alternate"></link><link href="https://www.andreagrandi.co.uk/feeds/howto-python.atom.xml" rel="self"></link><id>https://www.andreagrandi.co.uk/</id><updated>2016-04-10T19:05:00+01:00</updated><entry><title>How to publish a Python package to PyPI</title><link href="https://www.andreagrandi.co.uk/2016/04/10/how-to-publish-a-python-package-to-pypi/" rel="alternate"></link><published>2016-04-10T19:05:00+01:00</published><updated>2016-04-10T19:05:00+01:00</updated><author><name>admin</name></author><id>tag:www.andreagrandi.co.uk,2016-04-10:/2016/04/10/how-to-publish-a-python-package-to-pypi/</id><summary type="html">&lt;p&gt;&lt;strong&gt;PyPI&lt;/strong&gt; is the &lt;strong&gt;Python Package Index&lt;/strong&gt;, that archive that let you
install a package using pip, for example: &lt;strong&gt;pip install Flask&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;In the past days I started writing a &lt;strong&gt;Python API client&lt;/strong&gt; for
&lt;strong&gt;&lt;a href="https://www.toshl.com"&gt;Toshl&lt;/a&gt;&lt;/strong&gt; expense manager and I decided to
publish the library on PyPI. You can have a look …&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;strong&gt;PyPI&lt;/strong&gt; is the &lt;strong&gt;Python Package Index&lt;/strong&gt;, that archive that let you
install a package using pip, for example: &lt;strong&gt;pip install Flask&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;In the past days I started writing a &lt;strong&gt;Python API client&lt;/strong&gt; for
&lt;strong&gt;&lt;a href="https://www.toshl.com"&gt;Toshl&lt;/a&gt;&lt;/strong&gt; expense manager and I decided to
publish the library on PyPI. You can have a look at my library
here &lt;a href="https://github.com/andreagrandi/toshl-python"&gt;https://github.com/andreagrandi/toshl-python&lt;/a&gt; (please note: it's
still in development and &lt;a href="https://developer.toshl.com/"&gt;Toshl API&lt;/a&gt; is
not even public yet) in case you are not sure how to structure it.&lt;/p&gt;
&lt;p&gt;I found a &lt;a href="http://peterdowns.com/posts/first-time-with-pypi.html"&gt;nice
guide&lt;/a&gt; but it
wasn't complete (for example it didn't say how to sign packages) so I
decided to rewrite it adding more information.&lt;/p&gt;
&lt;h2&gt;Create PyPI accounts&lt;/h2&gt;
&lt;p&gt;To publish packages on PyPI you need to create two accounts: one for the
&lt;a href="http://pypi.python.org/pypi?%3Aaction=register_form"&gt;production server&lt;/a&gt;
and another one for the &lt;a href="http://testpypi.python.org/pypi?%3Aaction=register_form"&gt;test
server&lt;/a&gt;. When
you register, please specify (if you have one, but I really hope you do)
the &lt;strong&gt;PGP&lt;/strong&gt; id of your public key. Once the accounts are created, you
need to create a file named &lt;strong&gt;.pypirc&lt;/strong&gt; in your \$HOME folder containing
the following configuration:&lt;/p&gt;
&lt;p&gt;``` {.lang:sh .decode:true}
[distutils]
index-servers =
  pypi
  pypitest&lt;/p&gt;
&lt;p&gt;[pypi]
repository=https://pypi.python.org/pypi
username=your_username
password=your_password&lt;/p&gt;
&lt;p&gt;[pypitest]
repository=https://testpypi.python.org/pypi
username=your_username
password=your_password&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Please&lt;/span&gt; &lt;span class="n"&gt;substitute&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;your&lt;/span&gt;\&lt;span class="n"&gt;_username&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;your&lt;/span&gt;\&lt;span class="n"&gt;_password&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt; &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt;
&lt;span class="n"&gt;details&lt;/span&gt; &lt;span class="n"&gt;you&lt;/span&gt; &lt;span class="n"&gt;sent&lt;/span&gt; &lt;span class="n"&gt;during&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;registration&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;

&lt;span class="n"&gt;Preparing&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;package&lt;/span&gt;
&lt;span class="o"&gt;---------------------&lt;/span&gt;

&lt;span class="n"&gt;I&lt;/span&gt; &lt;span class="n"&gt;assume&lt;/span&gt; &lt;span class="n"&gt;you&lt;/span&gt; &lt;span class="n"&gt;have&lt;/span&gt; &lt;span class="n"&gt;structured&lt;/span&gt; &lt;span class="n"&gt;your&lt;/span&gt; &lt;span class="n"&gt;library&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;proper&lt;/span&gt; &lt;span class="n"&gt;way&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;have&lt;/span&gt;
&lt;span class="n"&gt;included&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;setup&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;py&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt; &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;all&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;configuration&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;it&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;s not something&lt;/span&gt;
&lt;span class="n"&gt;specific&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;PyPI&lt;/span&gt; &lt;span class="n"&gt;so&lt;/span&gt; &lt;span class="n"&gt;you&lt;/span&gt; &lt;span class="n"&gt;should&lt;/span&gt; &lt;span class="n"&gt;have&lt;/span&gt; &lt;span class="n"&gt;done&lt;/span&gt; &lt;span class="n"&gt;it&lt;/span&gt; &lt;span class="n"&gt;already&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="n"&gt;If&lt;/span&gt; &lt;span class="n"&gt;you&lt;/span&gt; &lt;span class="n"&gt;haven&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;t I&lt;/span&gt;
&lt;span class="n"&gt;remember&lt;/span&gt; &lt;span class="n"&gt;you&lt;/span&gt; &lt;span class="n"&gt;can&lt;/span&gt; &lt;span class="n"&gt;give&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;look&lt;/span&gt; &lt;span class="n"&gt;at&lt;/span&gt; &lt;span class="n"&gt;my&lt;/span&gt; &lt;span class="n"&gt;library&lt;/span&gt;
&lt;span class="n"&gt;here&lt;/span&gt;&lt;span class="err"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;https&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="n"&gt;github&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;andreagrandi&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;toshl&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;python&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="err"&gt; &lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;particular&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt;
&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;setup&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;py&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;

&lt;span class="sb"&gt;``&lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lang&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;python&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;decode&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;true&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;setuptools&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;setup&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;find_packages&lt;/span&gt;

&lt;span class="n"&gt;setup&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;toshl&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;version&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;0.0.3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;https://github.com/andreagrandi/toshl-python&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;download_url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;https://github.com/andreagrandi/toshl-python/tarball/0.0.3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;author&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Andrea Grandi&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;author_email&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;a.grandi@gmail.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;description&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Python client library for Toshl API.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;packages&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;find_packages&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;exclude&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;tests&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt;
    &lt;span class="n"&gt;zip_safe&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;include_package_data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;platforms&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;any&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;license&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MIT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;install_requires&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;requests==2.9.1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="p"&gt;],&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Upload the package to PyPI Test server&lt;/h2&gt;
&lt;p&gt;The first time you upload the package you will need to register it:&lt;/p&gt;
&lt;p&gt;``` {.lang:sh .decode:true}
python setup.py register -r pypitest&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;and then you will need to build the package and upload it (please note
I&amp;#39;m using the **--sign** to sign the package with PGP):

``` {.lang:sh .decode:true}
python setup.py sdist upload --sign -r pypitest
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Upload the package to PyPI production server&lt;/h2&gt;
&lt;p&gt;Once you have verified that you are able to build and upload the package
to the test server (without getting any errors), you should upload it to
the production server:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;{.lang:sh .decode:true}
python setup.py register -r pypi
python setup.py sdist upload --sign -r pypi&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;This is everything you need to do if you want to publish a Python
package on PyPI. Happy coding!&lt;/p&gt;</content><category term="pip"></category><category term="pypi"></category><category term="Python"></category></entry><entry><title>Using Python PyPy in a virtual environment</title><link href="https://www.andreagrandi.co.uk/2015/12/18/using-python-pypy-in-a-virtual-environment/" rel="alternate"></link><published>2015-12-18T17:29:00+00:00</published><updated>2015-12-18T17:29:00+00:00</updated><author><name>admin</name></author><id>tag:www.andreagrandi.co.uk,2015-12-18:/2015/12/18/using-python-pypy-in-a-virtual-environment/</id><summary type="html">&lt;p&gt;Sometimes we need to test if our code also works with
&lt;strong&gt;&lt;a href="http://pypy.org/"&gt;PyPy&lt;/a&gt;&lt;/strong&gt; implementation of &lt;strong&gt;Python&lt;/strong&gt;. Assuming you
have already installed it in your system, first find out where it is
installed:&lt;/p&gt;
&lt;p&gt;``` {.lang:zsh .decode:true}
➜  ~  which pypy
/usr/local/bin/pypy&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;then you need **mkvirtualenv** to create a virtual environment …&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;p&gt;Sometimes we need to test if our code also works with
&lt;strong&gt;&lt;a href="http://pypy.org/"&gt;PyPy&lt;/a&gt;&lt;/strong&gt; implementation of &lt;strong&gt;Python&lt;/strong&gt;. Assuming you
have already installed it in your system, first find out where it is
installed:&lt;/p&gt;
&lt;p&gt;``` {.lang:zsh .decode:true}
➜  ~  which pypy
/usr/local/bin/pypy&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;then you need **mkvirtualenv** to create a virtual environment that will
use this runtime:

``` {.lang:zsh .decode:true}
➜  ~  mkvirtualenv -p /usr/local/bin/pypy pypy-test
Running virtualenv with interpreter /usr/local/bin/pypy
New pypy executable in pypy-test/bin/pypy
Installing setuptools, pip, wheel...done.
(pypy-test)➜  ~  python
Python 2.7.10 (f3ad1e1e1d6215e20d34bb65ab85ff9188c9f559, Sep 01 2015, 06:26:30)
[PyPy 2.6.1 with GCC 4.2.1 Compatible Apple LLVM 6.1.0 (clang-602.0.53)] on darwin
Type &amp;quot;help&amp;quot;, &amp;quot;copyright&amp;quot;, &amp;quot;credits&amp;quot; or &amp;quot;license&amp;quot; for more information.
&amp;gt;&amp;gt;&amp;gt;&amp;gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;That's it! You can now use this virtual environment to run your Python
application using PyPy environment.&lt;/p&gt;</content><category term="pypy"></category><category term="Python"></category></entry></feed>