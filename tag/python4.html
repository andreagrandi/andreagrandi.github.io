
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="" />

  <link
    href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap"
    rel="stylesheet">

  <link rel="stylesheet" type="text/css" href="https://www.andreagrandi.it/theme/stylesheet/style.min.css">


  <link id="pygments-light-theme" rel="stylesheet" type="text/css"     href="https://www.andreagrandi.it/theme/pygments/monokai.min.css">

  <script src="https://www.andreagrandi.it/theme/tipuesearch/jquery.min.js"></script>
  <script defer src="https://www.andreagrandi.it/theme/tipuesearch/tipuesearch.min.js"></script>
  <script defer src="https://www.andreagrandi.it/theme/tipuesearch/tipuesearch_set.js"></script>
  <script defer src="https://www.andreagrandi.it/tipuesearch_content.js"></script>
  <link rel="stylesheet" href="https://www.andreagrandi.it/theme/tipuesearch/tipuesearch.min.css" />

  <link rel="stylesheet" type="text/css" href="https://www.andreagrandi.it/theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="https://www.andreagrandi.it/theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="https://www.andreagrandi.it/theme/font-awesome/css/solid.css">



  <link href="https://www.andreagrandi.it/feeds/all.rss.xml" type="application/rss+xml" rel="alternate"
    title="Andrea Grandi RSS">


<!-- Google Analytics -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-2140684-3', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics -->
  <!-- Chrome, Firefox OS and Opera -->
  <meta name="theme-color" content="#333333">
  <!-- Windows Phone -->
  <meta name="msapplication-navbutton-color" content="#333333">
  <!-- iOS Safari -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <!-- Microsoft EDGE -->
  <meta name="msapplication-TileColor" content="#333333">

  <meta name="author" content="Andrea Grandi" />
  <meta name="description" content="" />
<meta property="og:site_name" content="Andrea Grandi"/>
<meta property="og:type" content="blog"/>
<meta property="og:title" content="Andrea Grandi"/>
<meta property="og:description" content=""/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://www.andreagrandi.it"/>
<meta property="og:image" content="/images/me_pycon_2019_2_300x300.jpg">

  <title>Andrea Grandi &ndash; Tag python</title>


</head>

<body class="light-theme"
>
  <aside>
    <div>
      <a href="https://www.andreagrandi.it">
        <img src="/images/me_pycon_2019_2_300x300.jpg" alt="Andrea Grandi" title="Andrea Grandi">
      </a>

      <h1>
        <a href="https://www.andreagrandi.it">Andrea Grandi</a>
      </h1>

<p>Software Developer</p>
      <form class="navbar-search" action="/search.html" role="search">
        <input type="text" name="q" id="tipue_search_input" placeholder="Search...">
      </form>

      <nav>
        <ul class="list">


          <li>
            <a target="_self"
              href="https://www.andreagrandi.it/about/">
              About
            </a>
          </li>
          <li>
            <a target="_self"
              href="https://www.andreagrandi.it/curriculum/">
              Curriculum
            </a>
          </li>
          <li>
            <a target="_self"
              href="https://www.andreagrandi.it/pgp-key/">
              PGP Key
            </a>
          </li>

        </ul>
      </nav>

      <ul class="social">
        <li>
          <a  class="sc-twitter" href="https://twitter.com/andreagrandi" target="_blank">
            <i class="fab fa-twitter"></i>
          </a>
        </li>
        <li>
          <a  class="sc-github" href="https://github.com/andreagrandi" target="_blank">
            <i class="fab fa-github"></i>
          </a>
        </li>
        <li>
          <a  class="sc-linkedin" href="https://www.linkedin.com/in/andreagrandi/" target="_blank">
            <i class="fab fa-linkedin"></i>
          </a>
        </li>
      </ul>
    </div>

  </aside>
  <main>

    <nav>
      <a href="https://www.andreagrandi.it">Home</a>

      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>


      <a href="https://www.andreagrandi.it/feeds/all.rss.xml">RSS</a>
    </nav>



<article>
  <header>
    <h2><a href="https://www.andreagrandi.it/2016/09/28/creating-production-ready-api-python-django-rest-framework-part-1/">Creating a production ready API with Python and Django Rest Framework - part 1</a></h2>
    <p>
      Posted on Wed 28 September 2016 in <a href="https://www.andreagrandi.it/category/development.html">Development</a>

          &#8226; Tagged with
              <a href="https://www.andreagrandi.it/tag/api.html">API</a>,              <a href="https://www.andreagrandi.it/tag/django.html">Django</a>,              <a href="https://www.andreagrandi.it/tag/framework.html">framework</a>,              <a href="https://www.andreagrandi.it/tag/python.html">Python</a>,              <a href="https://www.andreagrandi.it/tag/rest.html">rest</a>,              <a href="https://www.andreagrandi.it/tag/tutorial.html">tutorial</a>
    </p>
  </header>
  <div>
      <p>The aim if this tutorial is to show how to create a production ready
solution for a <strong>REST API</strong>, using <strong>Python</strong> and <a href="http://www.django-rest-framework.org">Django Rest
Framework</a>. I will show you how to
first create a very basic API, how to handle the authentication and
permissions and I will cover deployment and hosting of images. The full
source code of the tutorial is available
at: <a href="https://github.com/andreagrandi/drf-tutorial">https://github.com/andreagrandi/drf-tutorial</a></p>
<h3>Summary of the complete tutorial</h3>
<ol>
<li>Create the basic structure for the API</li>
<li><a href="https://www.andreagrandi.it/2016/10/01/creating-a-production-ready-api-with-python-and-django-rest-framework-part-2/">Add Authentication and POST
    methods</a></li>
<li><a href="https://www.andreagrandi.it/2017/03/12/creating-a-production-ready-api-with-python-and-django-rest-framework-part-3/">Handling details and changes to existing
    data</a></li>
<li><a href="https://www.andreagrandi.it/2017/08/17/creating-a-production-ready-api-with-python-and-django-rest-framework-part-4/">Testing the API</a></li>
<li>Switching from Sqlite to PostgreSQL</li>
<li>Hosting the API on Heroku</li>
<li>Add an Image field and save images to S3</li>
</ol>
<h3>Create the basic structure for the API</h3>
<p>For this tutorial I will assume you have correctly installed at least
<strong>Python</strong> (I will use Python 2.7.x),
<a href="https://pypi.python.org/pypi/virtualenv"><strong>virtualenv</strong></a> and
<a href="https://virtualenvwrapper.readthedocs.io/en/latest/"><strong>virtualenvwrapper</strong></a>
on your system and I will explain how to create everything else step by
step.</p>
<p><strong>Note:</strong> at the time of writing, the tutorial has been based on
<strong>Django 1.10.1</strong> and <strong>Django Rest Framework 3.4.7</strong></p>
<h3>Creating the main project structure</h3>
<div class="highlight"><pre><span></span>mkdir drf-tutorial
mkvirtualenv drf-tutorial
<span class="nb">cd</span> drf-tutorial
pip install django djangorestframework
django-admin.py startproject drftutorial .
<span class="nb">cd</span> drftutorial
django-admin.py startapp catalog
</pre></div>


<h3>Data Model</h3>
<p>We will create the API for a generic products catalog, using a very
simple structure (to keep things simple). Edit the file
<strong>catalog/models.py</strong> adding these lines:</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">unicode_literals</span>
<span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>


<span class="k">class</span> <span class="nc">Product</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
    <span class="n">description</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">()</span>
    <span class="n">price</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DecimalField</span><span class="p">(</span><span class="n">decimal_places</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">max_digits</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>


<p>after creating the model, we need to add 'catalog' application to
<strong>INSTALLED_APPS</strong>. Edit <strong>settings.py</strong> and add the app at the end of
the list:</p>
<div class="highlight"><pre><span></span><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;django.contrib.admin&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.auth&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.contenttypes&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.sessions&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.messages&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.staticfiles&#39;</span><span class="p">,</span>
    <span class="s1">&#39;catalog&#39;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>


<p>at this point the Django application will be recognised by the project
and we can create and apply the schema migration:</p>
<div class="highlight"><pre><span></span><span class="o">(</span>drf-tutorial<span class="o">)</span> ➜  drftutorial git:<span class="o">(</span>235dfcc<span class="o">)</span> ✗ ./manage.py makemigrations
Migrations <span class="k">for</span> <span class="s1">&#39;catalog&#39;</span>:
    catalog/migrations/0001_initial.py:
        - Create model Product

<span class="o">(</span>drf-tutorial<span class="o">)</span> ➜  drftutorial git:<span class="o">(</span>235dfcc<span class="o">)</span> ✗ ./manage.py migrate
Operations to perform:
    Apply all migrations: admin, auth, catalog, contenttypes, sessions
    Running migrations:
        Applying contenttypes.0001_initial... OK
        Applying auth.0001_initial... OK
        Applying admin.0001_initial... OK
        Applying admin.0002_logentry_remove_auto_add... OK
        Applying contenttypes.0002_remove_content_type_name... OK
        Applying auth.0002_alter_permission_name_max_length... OK
        Applying auth.0003_alter_user_email_max_length... OK
        Applying auth.0004_alter_user_username_opts... OK
        Applying auth.0005_alter_user_last_login_null... OK
        Applying auth.0006_require_contenttypes_0002... OK
        Applying auth.0007_alter_validators_add_error_messages... OK
        Applying auth.0008_alter_user_username_max_length... OK
        Applying catalog.0001_initial... OK
        Applying sessions.0001_initial... OK
</pre></div>


<h3>API Serializer</h3>
<p><a href="http://www.django-rest-framework.org/api-guide/serializers/"><strong>Serializers</strong></a>
are those components used to convert the received data from JSON format
to the relative Django model and viceversa. Create the new file
<strong>catalog/serializers.py</strong> and place this code inside:</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Product</span>
<span class="kn">from</span> <span class="nn">rest_framework</span> <span class="kn">import</span> <span class="n">serializers</span>


<span class="k">class</span> <span class="nc">ProductSerializer</span><span class="p">(</span><span class="n">serializers</span><span class="o">.</span><span class="n">ModelSerializer</span><span class="p">):</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Product</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">)</span>
</pre></div>


<p>In this case we are using a
<a href="http://www.django-rest-framework.org/api-guide/serializers/#modelserializer"><strong>ModelSerializer</strong></a>.
We need to create a new class from it, and specify the model attribute,
that's it. In this case we also specify the fields we want to return.</p>
<h3>API View</h3>
<p>The serializer alone is not able to respond to an API request, that's
why we need to implement a view. In this first version of the view (that
we will improve soon) we will "manually" transform the data available in
the serializer dictionary to a JSON response. In <strong>catalog/views.py</strong>
add this code:</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">HttpResponse</span>
<span class="kn">from</span> <span class="nn">rest_framework.renderers</span> <span class="kn">import</span> <span class="n">JSONRenderer</span>
<span class="kn">from</span> <span class="nn">rest_framework.parsers</span> <span class="kn">import</span> <span class="n">JSONParser</span>
<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Product</span>
<span class="kn">from</span> <span class="nn">.serializers</span> <span class="kn">import</span> <span class="n">ProductSerializer</span>


<span class="k">class</span> <span class="nc">JSONResponse</span><span class="p">(</span><span class="n">HttpResponse</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An HttpResponse that renders its content into JSON.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">content</span> <span class="o">=</span> <span class="n">JSONRenderer</span><span class="p">()</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;content_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;application/json&#39;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">JSONResponse</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">product_list</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;GET&#39;</span><span class="p">:</span>
        <span class="n">products</span> <span class="o">=</span> <span class="n">Product</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="n">serializer</span> <span class="o">=</span> <span class="n">ProductSerializer</span><span class="p">(</span><span class="n">products</span><span class="p">,</span> <span class="n">many</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">JSONResponse</span><span class="p">(</span><span class="n">serializer</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>


<p>At this point we need to tell our Django app to use this API view when a
certain URL is requested. We first need to add this code in
<strong>catalog/urls.py</strong></p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">url</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">views</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^products/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">product_list</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>


<p>and finally we need to add this to <strong>drftutorial/urls.py</strong></p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">url</span><span class="p">,</span> <span class="n">include</span>
<span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^admin/&#39;</span><span class="p">,</span> <span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">urls</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s1">&#39;catalog.urls&#39;</span><span class="p">)),</span>
<span class="p">]</span>
</pre></div>


<h4>Testing our work</h4>
<p>At this point we should be able to start our Django app:</p>
<div class="highlight"><pre><span></span>./manage.py runserver
</pre></div>


<p>Let's install a tool that will help us to test the API:</p>
<div class="highlight"><pre><span></span>pip install httpie
</pre></div>


<p>now we can use it to call our URL:</p>
<div class="highlight"><pre><span></span>$ http http://127.0.0.1:8000/products/
HTTP/1.0 <span class="m">200</span> OK
Content-Type: application/json
Date: Wed, <span class="m">28</span> Sep <span class="m">2016</span> <span class="m">09</span>:54:50 GMT
Server: WSGIServer/0.1 Python/2.7.11
X-Frame-Options: SAMEORIGIN

<span class="o">[]</span>
</pre></div>


<p>It works! It's an empty response of course, because we still don't have
any data to show, but we will see later how to load some example data in
our database. If you have been able to follow the tutorial up to this
point, that's good. If not, don't worry. You can checkout the code at
exactly this point of the tutorial doing:</p>
<div class="highlight"><pre><span></span>git checkout tutorial-1.0
</pre></div>


<h3>Improving the API View</h3>
<p>There is a quicker and more efficient way of implementing the same API
view we have seen before. We can use a class based view, in particular
the APIView class and also have the JSON response implemented
automatically. Change the code inside <strong>catalog/views.py</strong> with this
one:</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">HttpResponse</span>
<span class="kn">from</span> <span class="nn">rest_framework.views</span> <span class="kn">import</span> <span class="n">APIView</span>
<span class="kn">from</span> <span class="nn">rest_framework.response</span> <span class="kn">import</span> <span class="n">Response</span>
<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Product</span>
<span class="kn">from</span> <span class="nn">.serializers</span> <span class="kn">import</span> <span class="n">ProductSerializer</span>


<span class="k">class</span> <span class="nc">ProductList</span><span class="p">(</span><span class="n">APIView</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">products</span> <span class="o">=</span> <span class="n">Product</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="n">serializer</span> <span class="o">=</span> <span class="n">ProductSerializer</span><span class="p">(</span><span class="n">products</span><span class="p">,</span> <span class="n">many</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="n">serializer</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>


<p>You will also have to change <strong>catalog/urls.py</strong> in this way:</p>
<div class="highlight"><pre><span></span><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^products/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">ProductList</span><span class="o">.</span><span class="n">as_view</span><span class="p">()),</span>
<span class="p">]</span>
</pre></div>


<p>You can check the source code for this step of the tutorial with:</p>
<div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">checkout</span> <span class="n">tutorial</span><span class="o">-</span><span class="mf">1.1</span>
</pre></div>


<p>There is also another way of writing the same view. Let's try it with
<a href="http://www.django-rest-framework.org/api-guide/generic-views/#listapiview"><strong>ListAPIView</strong></a>.
Edit <strong>catalog/views.py</strong> again and substitute the code with this one:</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">HttpResponse</span>
<span class="kn">from</span> <span class="nn">rest_framework</span> <span class="kn">import</span> <span class="n">generics</span>
<span class="kn">from</span> <span class="nn">rest_framework.response</span> <span class="kn">import</span> <span class="n">Response</span>
<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Product</span>
<span class="kn">from</span> <span class="nn">.serializers</span> <span class="kn">import</span> <span class="n">ProductSerializer</span>


<span class="k">class</span> <span class="nc">ProductList</span><span class="p">(</span><span class="n">generics</span><span class="o">.</span><span class="n">ListAPIView</span><span class="p">):</span>
    <span class="n">queryset</span> <span class="o">=</span> <span class="n">Product</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
    <span class="n">serializer_class</span> <span class="o">=</span> <span class="n">ProductSerializer</span>
</pre></div>


<p>With a <strong>ListAPIView</strong> we are basically creating a read-only API that is
supposed to return a list of items. We need to specify a <strong>queryset</strong>
and the <strong>serializer_class</strong> parameters. Once again, you can get up to
this point, checking out the related git tag:</p>
<div class="highlight"><pre><span></span>git checkout tutorial-1.2
</pre></div>


<h3>Creating Initial Data</h3>
<p>An API that doesn't return any data is not very useful, right? Also, at
the moment we haven't implemented yet any feature that let us insert any
data. That's why I've created a data migration for you that will insert
some data for you. You may notice that the example data contains some
Italian products... out of the scope of this tutorial, I strongly advise
you to google this products and if you ever happen to visit Italy, try
them. You won't regret!</p>
<p>Going back to our data migration, you first have to create an empty one
with:</p>
<div class="highlight"><pre><span></span>./manage.py makemigrations --empty catalog
</pre></div>


<p>and then open the file that has been created under
<strong>catalog/migrations/</strong> named <strong>0002_.....</strong> (your name will be
different from mine, so just edit the one starting with 0002 and you
will be fine) and fill it with this code:</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">unicode_literals</span>
<span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">migrations</span>


<span class="k">def</span> <span class="nf">create_initial_products</span><span class="p">(</span><span class="n">apps</span><span class="p">,</span> <span class="n">schema_editor</span><span class="p">):</span>
    <span class="n">Product</span> <span class="o">=</span> <span class="n">apps</span><span class="o">.</span><span class="n">get_model</span><span class="p">(</span><span class="s1">&#39;catalog&#39;</span><span class="p">,</span> <span class="s1">&#39;Product&#39;</span><span class="p">)</span>

    <span class="n">Product</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Salame&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Salame Toscano&#39;</span><span class="p">,</span> <span class="n">price</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
    <span class="n">Product</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Olio Balsamico&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Olio balsamico di Modena&#39;</span><span class="p">,</span> <span class="n">price</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
    <span class="n">Product</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Parmigiano&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Parmigiano Reggiano&#39;</span><span class="p">,</span> <span class="n">price</span><span class="o">=</span><span class="mf">8.50</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
    <span class="n">Product</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Olio&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Olio Oliva Toscano&#39;</span><span class="p">,</span> <span class="n">price</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
    <span class="n">Product</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Porchetta&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Porchetta toscana cotta a legna&#39;</span><span class="p">,</span> <span class="n">price</span><span class="o">=</span><span class="mf">7.50</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
    <span class="n">Product</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Cantucci&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Cantucci di Prato&#39;</span><span class="p">,</span> <span class="n">price</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
    <span class="n">Product</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Vino Rosso&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Vino Rosso del Chianti&#39;</span><span class="p">,</span> <span class="n">price</span><span class="o">=</span><span class="mf">9.50</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
    <span class="n">Product</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Brigidini&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Brigidini di Lamporecchio&#39;</span><span class="p">,</span> <span class="n">price</span><span class="o">=</span><span class="mf">3.50</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>


<span class="k">class</span> <span class="nc">Migration</span><span class="p">(</span><span class="n">migrations</span><span class="o">.</span><span class="n">Migration</span><span class="p">):</span>

    <span class="n">dependencies</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="s1">&#39;catalog&#39;</span><span class="p">,</span> <span class="s1">&#39;0001_initial&#39;</span><span class="p">),</span>
    <span class="p">]</span>

    <span class="n">operations</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">migrations</span><span class="o">.</span><span class="n">RunPython</span><span class="p">(</span><span class="n">create_initial_products</span><span class="p">),</span>
    <span class="p">]</span>
</pre></div>


<p>to apply the migration we just created, just do:</p>
<div class="highlight"><pre><span></span>./manage.py migrate
</pre></div>


<p>If you try to test the API again from the command line, you will get
these products back:</p>
<div class="highlight"><pre><span></span>$ http http://127.0.0.1:8000/products/
HTTP/1.0 <span class="m">200</span> OK
Allow: GET, HEAD, OPTIONS
Content-Type: application/json
Date: Wed, <span class="m">28</span> Sep <span class="m">2016</span> <span class="m">12</span>:29:36 GMT
Server: WSGIServer/0.1 Python/2.7.11
Vary: Accept, Cookie
X-Frame-Options: SAMEORIGIN

<span class="o">[</span>
    <span class="o">{</span>
        <span class="s2">&quot;description&quot;</span>: <span class="s2">&quot;Salame Toscano&quot;</span>,
        <span class="s2">&quot;name&quot;</span>: <span class="s2">&quot;Salame&quot;</span>,
        <span class="s2">&quot;price&quot;</span>: <span class="s2">&quot;12.00&quot;</span>
    <span class="o">}</span>,
    <span class="o">{</span>
        <span class="s2">&quot;description&quot;</span>: <span class="s2">&quot;Olio balsamico di Modena&quot;</span>,
        <span class="s2">&quot;name&quot;</span>: <span class="s2">&quot;Olio Balsamico&quot;</span>,
        <span class="s2">&quot;price&quot;</span>: <span class="s2">&quot;10.00&quot;</span>
    <span class="o">}</span>,
    <span class="o">{</span>
        <span class="s2">&quot;description&quot;</span>: <span class="s2">&quot;Parmigiano Reggiano&quot;</span>,
        <span class="s2">&quot;name&quot;</span>: <span class="s2">&quot;Parmigiano&quot;</span>,
        <span class="s2">&quot;price&quot;</span>: <span class="s2">&quot;8.50&quot;</span>
    <span class="o">}</span>,
    <span class="o">{</span>
        <span class="s2">&quot;description&quot;</span>: <span class="s2">&quot;Olio Oliva Toscano&quot;</span>,
        <span class="s2">&quot;name&quot;</span>: <span class="s2">&quot;Olio&quot;</span>,
        <span class="s2">&quot;price&quot;</span>: <span class="s2">&quot;13.00&quot;</span>
    <span class="o">}</span>,
    <span class="o">{</span>
        <span class="s2">&quot;description&quot;</span>: <span class="s2">&quot;Porchetta toscana cotta a legna&quot;</span>,
        <span class="s2">&quot;name&quot;</span>: <span class="s2">&quot;Porchetta&quot;</span>,
        <span class="s2">&quot;price&quot;</span>: <span class="s2">&quot;7.50&quot;</span>
    <span class="o">}</span>,
    <span class="o">{</span>
        <span class="s2">&quot;description&quot;</span>: <span class="s2">&quot;Cantucci di Prato&quot;</span>,
        <span class="s2">&quot;name&quot;</span>: <span class="s2">&quot;Cantucci&quot;</span>,
        <span class="s2">&quot;price&quot;</span>: <span class="s2">&quot;4.00&quot;</span>
    <span class="o">}</span>,
    <span class="o">{</span>
        <span class="s2">&quot;description&quot;</span>: <span class="s2">&quot;Vino Rosso del Chianti&quot;</span>,
        <span class="s2">&quot;name&quot;</span>: <span class="s2">&quot;Vino Rosso&quot;</span>,
        <span class="s2">&quot;price&quot;</span>: <span class="s2">&quot;9.50&quot;</span>
    <span class="o">}</span>,
    <span class="o">{</span>
        <span class="s2">&quot;description&quot;</span>: <span class="s2">&quot;Brigidini di Lamporecchio&quot;</span>,
        <span class="s2">&quot;name&quot;</span>: <span class="s2">&quot;Brigidini&quot;</span>,
        <span class="s2">&quot;price&quot;</span>: <span class="s2">&quot;3.50&quot;</span>
    <span class="o">}</span>
<span class="o">]</span>
</pre></div>


<p>Again, you can get up to this point with:</p>
<div class="highlight"><pre><span></span>git checkout tutorial-1.3
</pre></div>


<h3>One more thing...</h3>
<p>No, we are not going to present a new amazing device, I'm sorry, but I
want to show you a nice Django Rest Framework feature you can have
without much additional work. Edit <strong>settings.py</strong> and add
<strong>rest_framework</strong> to the list of <strong>INSTALLED_APPS</strong>:</p>
<div class="highlight"><pre><span></span><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;django.contrib.admin&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.auth&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.contenttypes&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.sessions&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.messages&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.staticfiles&#39;</span><span class="p">,</span>
    <span class="s1">&#39;rest_framework&#39;</span><span class="p">,</span>
    <span class="s1">&#39;catalog&#39;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>


<p>Now, if you are still running the Django app, try to visit this url from
your browser: <a href="http://127.0.0.1:8000/products/">http://127.0.0.1:8000/products/</a><br>
That's very nice, isn't it? You can have browsable APIs at no cost.</p>
<h3>Wrapping Up</h3>
<p>I've mentioned at the beginning that this is just the first part of my
API tutorial. In the <a href="https://www.andreagrandi.it/2016/10/01/creating-a-production-ready-api-with-python-and-django-rest-framework-part-2/">next
part</a>
I will show you how to let the consumer of your API add some products
and leave reviews (we will introduce a new model for this). Also, we
will see how to set proper permissions to these new API methods so that
only admin users will be able to add products while normal users will be
able to add reviews. So, if you feel ready, you can begin to follow the
<a href="https://www.andreagrandi.it/2016/10/01/creating-a-production-ready-api-with-python-and-django-rest-framework-part-2/">second part of this tutorial</a></p>
<h3>References</h3>
<p>Some parts of this tutorial and a few examples have been taken directly
from the original <a href="http://www.django-rest-framework.org/tutorial/quickstart/">Django Rest Framework
tutorial</a>.</p>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="https://www.andreagrandi.it/2016/05/10/using-python-ipdb-from-jupyter/">Using Python ipdb from Jupyter</a></h2>
    <p>
      Posted on Tue 10 May 2016 in <a href="https://www.andreagrandi.it/category/development.html">Development</a>

          &#8226; Tagged with
              <a href="https://www.andreagrandi.it/tag/debugging.html">debugging</a>,              <a href="https://www.andreagrandi.it/tag/ipdb.html">ipdb</a>,              <a href="https://www.andreagrandi.it/tag/python.html">Python</a>
    </p>
  </header>
  <div>
      <p>If we try to use the usual ipdb commands from a Jupyter (IPython
notebook)</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ipdb</span><span class="p">;</span> <span class="n">ipdb</span><span class="o">.</span><span class="n">set_trace</span><span class="p">()</span>
</pre></div>


<p>we will get a similar error:</p>
<div class="highlight"><pre><span></span><span class="o">--------------------------------------------------------------------------</span>
<span class="n">MultipleInstanceError</span>                     <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">f2b356251c56</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
    <span class="mi">1</span> <span class="n">a</span><span class="o">=</span><span class="mi">4</span>
<span class="o">----&gt;</span> <span class="mi">2</span> <span class="kn">import</span> <span class="nn">ipdb</span><span class="p">;</span> <span class="n">ipdb</span><span class="o">.</span><span class="n">set_trace</span><span class="p">()</span>
    <span class="mi">3</span> <span class="n">b</span><span class="o">=</span><span class="mi">5</span>
    <span class="mi">4</span> <span class="nb">print</span> <span class="n">a</span>
    <span class="mi">5</span> <span class="nb">print</span> <span class="n">b</span>

<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">nnn</span><span class="o">/</span><span class="n">anaconda</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python2</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">ipdb</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
    <span class="mi">14</span> <span class="c1"># You should have received a copy of the GNU General Public License along with this program. If not, see http://www.gnu.org/licenses/.</span>
    <span class="mi">15</span> 
<span class="o">---&gt;</span> <span class="mi">16</span> <span class="kn">from</span> <span class="nn">ipdb.__main__</span> <span class="kn">import</span> <span class="n">set_trace</span><span class="p">,</span> <span class="n">post_mortem</span><span class="p">,</span> <span class="n">pm</span><span class="p">,</span> <span class="n">run</span><span class="p">,</span> <span class="n">runcall</span><span class="p">,</span> <span class="n">runeval</span><span class="p">,</span> <span class="n">launch_ipdb_on_exception</span>
    <span class="mi">17</span> 
    <span class="mi">18</span> <span class="n">pm</span>                       <span class="c1"># please pyflakes</span>

<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">nnn</span><span class="o">/</span><span class="n">anaconda</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python2</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">ipdb</span><span class="o">/</span><span class="n">__main__</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
    <span class="mi">71</span>         <span class="c1"># the instance method will create a new one without loading the config.</span>
    <span class="mi">72</span>         <span class="c1"># i.e: if we are in an embed instance we do not want to load the config.</span>
<span class="o">---&gt;</span> <span class="mi">73</span>         <span class="n">ipapp</span> <span class="o">=</span> <span class="n">TerminalIPythonApp</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span>
    <span class="mi">74</span>         <span class="n">shell</span> <span class="o">=</span> <span class="n">get_ipython</span><span class="p">()</span>
    <span class="mi">75</span>         <span class="n">def_colors</span> <span class="o">=</span> <span class="n">shell</span><span class="o">.</span><span class="n">colors</span>

<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">nnn</span><span class="o">/</span><span class="n">anaconda</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python2</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">traitlets</span><span class="o">/</span><span class="n">config</span><span class="o">/</span><span class="n">configurable</span><span class="o">.</span><span class="n">pyc</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="mi">413</span>             <span class="k">raise</span> <span class="n">MultipleInstanceError</span><span class="p">(</span>
    <span class="mi">414</span>                 <span class="s1">&#39;Multiple incompatible subclass instances of &#39;</span>
<span class="o">--&gt;</span> <span class="mi">415</span>                 <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> are being created.&#39;</span> <span class="o">%</span> <span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span>
    <span class="mi">416</span>             <span class="p">)</span>
    <span class="mi">417</span>

<span class="n">MultipleInstanceError</span><span class="p">:</span> <span class="n">Multiple</span> <span class="n">incompatible</span> <span class="n">subclass</span> <span class="n">instances</span> <span class="n">of</span> <span class="n">TerminalIPythonApp</span> <span class="n">are</span> <span class="n">being</span> <span class="n">created</span><span class="o">.</span>
</pre></div>


<p>The solution is to use Tracer instead:</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.core.debugger</span> <span class="kn">import</span> <span class="n">Tracer</span>
<span class="n">Tracer</span><span class="p">()()</span>
</pre></div>


<p><strong>Source:</strong> <a href="http://stackoverflow.com/questions/35613249/using-ipdb-to-debug-python-code-in-one-cell-jupyter-or-ipython">http://stackoverflow.com/questions/35613249/using-ipdb-to-debug-python-code-in-one-cell-jupyter-or-ipython</a></p>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="https://www.andreagrandi.it/2016/04/10/how-to-publish-a-python-package-to-pypi/">How to publish a Python package to PyPI</a></h2>
    <p>
      Posted on Sun 10 April 2016 in <a href="https://www.andreagrandi.it/category/development.html">Development</a>

          &#8226; Tagged with
              <a href="https://www.andreagrandi.it/tag/pip.html">pip</a>,              <a href="https://www.andreagrandi.it/tag/pypi.html">pypi</a>,              <a href="https://www.andreagrandi.it/tag/python.html">Python</a>
    </p>
  </header>
  <div>
      <p><strong>PyPI</strong> is the <strong>Python Package Index</strong>, that archive that let you
install a package using pip, for example: <strong>pip install Flask</strong></p>
<p>In the past days I started writing a <strong>Python API client</strong> for
<strong><a href="https://www.toshl.com">Toshl</a></strong> expense manager and I decided to
publish the library on PyPI. You can have a look at my library
here <a href="https://github.com/andreagrandi/toshl-python">https://github.com/andreagrandi/toshl-python</a> (please note: it's
still in development and <a href="https://developer.toshl.com/">Toshl API</a> is
not even public yet) in case you are not sure how to structure it.</p>
<p>I found a <a href="http://peterdowns.com/posts/first-time-with-pypi.html">nice
guide</a> but it
wasn't complete (for example it didn't say how to sign packages) so I
decided to rewrite it adding more information.</p>
<h3>Create PyPI accounts</h3>
<p>To publish packages on PyPI you need to create two accounts: one for the
<a href="http://pypi.python.org/pypi?%3Aaction=register_form">production server</a>
and another one for the <a href="http://testpypi.python.org/pypi?%3Aaction=register_form">test
server</a>. When
you register, please specify (if you have one, but I really hope you do)
the <strong>PGP</strong> id of your public key. Once the accounts are created, you
need to create a file named <strong>.pypirc</strong> in your \$HOME folder containing
the following configuration:</p>
<div class="highlight"><pre><span></span><span class="o">[</span>distutils<span class="o">]</span>
index-servers <span class="o">=</span>
pypi
pypitest

<span class="o">[</span>pypi<span class="o">]</span>
<span class="nv">repository</span><span class="o">=</span>https://pypi.python.org/pypi
<span class="nv">username</span><span class="o">=</span>your_username
<span class="nv">password</span><span class="o">=</span>your_password

<span class="o">[</span>pypitest<span class="o">]</span>
<span class="nv">repository</span><span class="o">=</span>https://testpypi.python.org/pypi
<span class="nv">username</span><span class="o">=</span>your_username
<span class="nv">password</span><span class="o">=</span>your_password
</pre></div>


<p>Please substitute <strong>your_username</strong> and <strong>your_password</strong> with the
details you sent during the registration.</p>
<h3>Preparing the package</h3>
<p>I assume you have structured your library in the proper way and have
included a <strong>setup.py</strong> with all the configuration (it's not something
specific to PyPI so you should have done it already). If you haven't I
remember you can give a look at my library
here <a href="https://github.com/andreagrandi/toshl-python">https://github.com/andreagrandi/toshl-python</a> in particular to the
<strong>setup.py</strong>:</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">setuptools</span> <span class="kn">import</span> <span class="n">setup</span><span class="p">,</span> <span class="n">find_packages</span>

<span class="n">setup</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;toshl&#39;</span><span class="p">,</span>
    <span class="n">version</span><span class="o">=</span><span class="s1">&#39;0.0.3&#39;</span><span class="p">,</span>
    <span class="n">url</span><span class="o">=</span><span class="s1">&#39;https://github.com/andreagrandi/toshl-python&#39;</span><span class="p">,</span>
    <span class="n">download_url</span><span class="o">=</span><span class="s1">&#39;https://github.com/andreagrandi/toshl-python/tarball/0.0.3&#39;</span><span class="p">,</span>
    <span class="n">author</span><span class="o">=</span><span class="s1">&#39;Andrea Grandi&#39;</span><span class="p">,</span>
    <span class="n">author_email</span><span class="o">=</span><span class="s1">&#39;a.grandi@gmail.com&#39;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Python client library for Toshl API.&#39;</span><span class="p">,</span>
    <span class="n">packages</span><span class="o">=</span><span class="n">find_packages</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;tests&#39;</span><span class="p">]),</span>
    <span class="n">zip_safe</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">include_package_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">platforms</span><span class="o">=</span><span class="s1">&#39;any&#39;</span><span class="p">,</span>
    <span class="n">license</span><span class="o">=</span><span class="s1">&#39;MIT&#39;</span><span class="p">,</span>
    <span class="n">install_requires</span><span class="o">=</span><span class="p">[</span>
        <span class="s1">&#39;requests==2.9.1&#39;</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">)</span>
</pre></div>


<h3>Upload the package to PyPI Test server</h3>
<p>The first time you upload the package you will need to register it:</p>
<div class="highlight"><pre><span></span>python setup.py register -r pypitest
</pre></div>


<p>and then you will need to build the package and upload it (please note
I'm using the <strong>--sign</strong> to sign the package with PGP):</p>
<div class="highlight"><pre><span></span>python setup.py sdist upload --sign -r pypitest
</pre></div>


<h3>Upload the package to PyPI production server</h3>
<p>Once you have verified that you are able to build and upload the package
to the test server (without getting any errors), you should upload it to
the production server:</p>
<div class="highlight"><pre><span></span>python setup.py register -r pypi
python setup.py sdist upload --sign -r pypi
</pre></div>


<p>This is everything you need to do if you want to publish a Python
package on PyPI. Happy coding!</p>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="https://www.andreagrandi.it/2016/02/08/using-a-light-sensor-with-bbc-microbit-and-micropython/">Using a light sensor with BBC micro:bit and MicroPython</a></h2>
    <p>
      Posted on Mon 08 February 2016 in <a href="https://www.andreagrandi.it/category/development.html">Development</a>

          &#8226; Tagged with
              <a href="https://www.andreagrandi.it/tag/bbc.html">bbc</a>,              <a href="https://www.andreagrandi.it/tag/breadboard.html">breadboard</a>,              <a href="https://www.andreagrandi.it/tag/embedded.html">embedded</a>,              <a href="https://www.andreagrandi.it/tag/microbit.html">microbit</a>,              <a href="https://www.andreagrandi.it/tag/micropython.html">micropython</a>,              <a href="https://www.andreagrandi.it/tag/howto.html">howto</a>,              <a href="https://www.andreagrandi.it/tag/python.html">python</a>
    </p>
  </header>
  <div>
      <p>A <strong><a href="https://en.wikipedia.org/wiki/Photoresistor">light sensor</a></strong> is a
small component with a particular characteristic: it is basically a
resistor and its resistance decreases if the light is more intense. To
use it with micro:bit we need to use one of the <strong>analogic ports</strong>. To
build this circuit you will need a <strong>breadboard</strong>, <strong>3 jumper wires</strong>, a
<strong>10k resistance</strong> and possibly a <strong><a href="https://www.kitronik.co.uk/5609-prototyping-system-for-the-bbc-microbit.html">Kitronik breadboard
kit</a></strong>.</p>
<h3>The project</h3>
<p>I wanted to realise a simple project where, depending on the light
intensity captured by the light sensor, the <strong>micro:bit</strong> shows an image
of the <strong>Sun</strong> if the light is intense and an image of the <strong>Moon</strong> if
the light is less intense.</p>
<p>Here is the complete <strong>circuit scheme</strong>:</p>
<p><a href="https://www.andreagrandi.it/images/2016/02/microbit_breadboard_schema_light.png"><img alt="microbit_breadboard_schema_light" src="https://www.andreagrandi.it/images/2016/02/microbit_breadboard_schema_light.png" width="40%"></a></p>
<h6>"Image Copyright © Kitronik"</h6>
<p>and here is a picture of the <strong>finished project</strong> I created:</p>
<p><a href="https://www.andreagrandi.it/images/2016/02/microbit_breadboard_example_2.jpg"><img alt="microbit_breadboard_example_2" src="https://www.andreagrandi.it/images/2016/02/microbit_breadboard_example_2.jpg" width="40%"></a></p>
<p>The <strong>source code</strong> I needed is available here:</p>
<p>
<script src="https://gist.github.com/andreagrandi/99a09be27c9626b1119d.js"></script>
</p>

<p>and as a demo I realised this small <strong>video</strong>:</p>
<iframe width="420" height="315" src="https://www.youtube.com/embed/6vLE_AQc4Bc" frameborder="0" allowfullscreen="allowfullscreen"></iframe>
  </div>
</article>

  <div class="pagination">
    <a class="btn float-left" href="https://www.andreagrandi.it/tag/python5.html">
      <i class="fa fa-angle-left"></i> Older Posts
    </a>
    <a class="btn float-right" href="https://www.andreagrandi.it/tag/python3.html">
      Newer Posts <i class="fa fa-angle-right"></i>
    </a>
  </div>



    <footer>
<p>
  &copy; 2020  - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>
</p>
<p>
  Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme - source code available on <a href="https://github.com/andreagrandi/andreagrandi.it" target="_blank">GitHub</a>
</p><p>
  <a rel="license"
     href="http://creativecommons.org/licenses/by-sa/4.0/"
     target="_blank">
    <img alt="Creative Commons License"
         title="Creative Commons License"
         style="border-width:0"
           src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png"
         width="80"
         height="15"/>
  </a>
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Andrea Grandi ",
  "url" : "https://www.andreagrandi.it",
  "image": "/images/me_pycon_2019_2_300x300.jpg",
  "description": ""
}
</script>

  <script>
    $(document).ready(function () {
      $('#tipue_search_input').tipuesearch();
    });
  </script>

</body>

</html>