<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Andrea Grandi - Python</title>
        <link rel="stylesheet" href="https://www.andreagrandi.it/theme/css/main.css" />
        <link rel="stylesheet" href="https://www.andreagrandi.it/theme/tipuesearch/css/tipuesearch.css">

        <!--[if IE]>
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
        <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
        <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="https://www.andreagrandi.it/">Andrea Grandi </a></h1>
                <nav><ul>
    
                        <li><a href="https://www.andreagrandi.it/about/">About</a></li>
    
                        <li><a href="https://www.andreagrandi.it/curriculum/">Curriculum</a></li>
    
                        <li><a href="https://www.andreagrandi.it/pgp-key/">PGP Key</a></li>
                </ul>
<form id="search" action="https://www.andreagrandi.it/search.html" onsubmit="return validateForm(this.elements['q'].value);">
                        <input type="text" class="search-query" placeholder="" name="q" id="tipue_search_input">
                    </form>
                </nav>
        </header><!-- /#banner -->

                <section id="content" class="body">
                    <ol id="posts-list" class="hfeed" start="3">
            <li><article class="hentry">
                <header>
                    <h1><a href="https://www.andreagrandi.it/2016/01/26/using-bbc-microbit-accelerometer-with-python/" rel="bookmark"
                           title="Permalink to Using BBC MicroBit accelerometer with Python">Using BBC MicroBit accelerometer with Python</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <span>Tue 26 January 2016</span>
	        <span>| in <a href="https://www.andreagrandi.it/category/development.html">Development</a></span>
<span>| tags: <a href="https://www.andreagrandi.it/tag/bbc.html">bbc</a><a href="https://www.andreagrandi.it/tag/microbit.html">microbit</a><a href="https://www.andreagrandi.it/tag/python.html">Python</a><a href="https://www.andreagrandi.it/tag/howto.html">howto</a></span>
</footer><!-- /.post-info -->                <p>In these days I'm having a bit of fun with <strong><a href="https://www.microbit.co.uk/">BBC
MicroBit</a></strong> board and I'm learning how to
use the different sensors available. The latest one I wanted to try was
the accelerometer. The board can "sense" if you are moving it in any of
the 3 dimensional axes: X, Y, Z. According to the
<a href="https://microbit-micropython.readthedocs.org/en/latest/accelerometer.html">documentation</a>
there are four methods available that can be used to get these
values: <strong>microbit.accelerometer.get_values()</strong> will return you a tuple with all the 3 values, while 
<strong>microbit.accelerometer.get_x()</strong>, <strong>microbit.accelerometer.get_y()</strong>, <strong>microbit.accelerometer.get_z()</strong>
will give you the single values.</p>
<p>The documentation on the official website doesn't explain much and for
example I didn't even know what was the range of the values I can get
back from these methods (by the way it's <strong>between -1024</strong> and
<strong>1024</strong>), so I decided to play with the code directly and write a very
simple example. The small example I wrote, shows a smile on the board
display if you keep it straight and shows a sad face if you bend it.</p>
<p>This is the result:</p>
<iframe width="420" height="315" src="https://www.youtube.com/embed/LX8fYBsOxA0" frameborder="0" allowfullscreen="allowfullscreen"></iframe>

<p>and this is all the needed code of the application:</p>
<p>
<script src="https://gist.github.com/andreagrandi/f4a7c8ee8597dde3070d.js"></script>
</p>

<p>In the next days I will try to play with more sensors and to publish
other examples.</p>
                <a class="readmore" href="https://www.andreagrandi.it/2016/01/26/using-bbc-microbit-accelerometer-with-python/">read more</a>
<p><a href="https://www.andreagrandi.it/2016/01/26/using-bbc-microbit-accelerometer-with-python/#disqus_thread">comments</a></p>                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="https://www.andreagrandi.it/2015/12/18/using-python-pypy-in-a-virtual-environment/" rel="bookmark"
                           title="Permalink to Using Python PyPy in a virtual environment">Using Python PyPy in a virtual environment</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <span>Fri 18 December 2015</span>
	        <span>| in <a href="https://www.andreagrandi.it/category/howto-python.html">HowTo, Python</a></span>
<span>| tags: <a href="https://www.andreagrandi.it/tag/pypy.html">pypy</a><a href="https://www.andreagrandi.it/tag/python.html">Python</a></span>
</footer><!-- /.post-info -->                <p>Sometimes we need to test if our code also works with
<strong><a href="http://pypy.org/">PyPy</a></strong> implementation of <strong>Python</strong>. Assuming you
have already installed it in your system, first find out where it is
installed:</p>
<p>``` {.lang:zsh .decode:true}
➜  ~  which pypy
/usr/local/bin/pypy</p>
<div class="highlight"><pre><span></span>then you need **mkvirtualenv** to create a virtual environment that will
use this runtime:

``` {.lang:zsh .decode:true}
➜  ~  mkvirtualenv -p /usr/local/bin/pypy pypy-test
Running virtualenv with interpreter /usr/local/bin/pypy
New pypy executable in pypy-test/bin/pypy
Installing setuptools, pip, wheel...done.
(pypy-test)➜  ~  python
Python 2.7.10 (f3ad1e1e1d6215e20d34bb65ab85ff9188c9f559, Sep 01 2015, 06:26:30)
[PyPy 2.6.1 with GCC 4.2.1 Compatible Apple LLVM 6.1.0 (clang-602.0.53)] on darwin
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&gt;&gt;&gt;&gt;
</pre></div>


<p>That's it! You can now use this virtual environment to run your Python
application using PyPy environment.</p>
                <a class="readmore" href="https://www.andreagrandi.it/2015/12/18/using-python-pypy-in-a-virtual-environment/">read more</a>
<p><a href="https://www.andreagrandi.it/2015/12/18/using-python-pypy-in-a-virtual-environment/#disqus_thread">comments</a></p>                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="https://www.andreagrandi.it/2015/10/11/reversing-a-list-in-python/" rel="bookmark"
                           title="Permalink to Reversing a List in Python">Reversing a List in Python</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <span>Sun 11 October 2015</span>
	        <span>| in <a href="https://www.andreagrandi.it/category/python.html">Python</a></span>
<span>| tags: <a href="https://www.andreagrandi.it/tag/lists.html">lists</a><a href="https://www.andreagrandi.it/tag/python.html">Python</a><a href="https://www.andreagrandi.it/tag/reversed.html">reversed</a></span>
</footer><!-- /.post-info -->                <p>Sometimes we need to reverse the order of the elements in a Python list.
While there can be many different ways of implementing this task, I
found three in particular that I appreciate for different reasons. Let's
define first a list of integers that we will reverse later.</p>
<p>``` {.lang:python .decode:true}
l = [1, 2, 3, 4, 5, 6]</p>
<div class="highlight"><pre><span></span><span class="nv">List</span> <span class="s s-Atom">slicing</span>
<span class="s s-Atom">------------</span>

<span class="nv">This</span> <span class="s s-Atom">method</span> <span class="s s-Atom">can</span> <span class="s s-Atom">be</span> <span class="s s-Atom">a</span> <span class="s s-Atom">bit</span> <span class="s s-Atom">obscure</span> <span class="s s-Atom">at</span> <span class="s s-Atom">first</span> <span class="s s-Atom">read</span><span class="p">,</span> <span class="s s-Atom">but</span> <span class="s s-Atom">basically</span> <span class="s s-Atom">it</span> <span class="s s-Atom">slices</span>
<span class="s s-Atom">the</span> <span class="s s-Atom">whole</span> <span class="s s-Atom">list</span> <span class="s s-Atom">proceding</span> <span class="s s-Atom">in</span> <span class="s s-Atom">the</span> <span class="s s-Atom">reverse</span> <span class="nn">order</span><span class="p">:</span>

<span class="err">```</span> <span class="p">{.</span><span class="nn">lang</span><span class="p">:</span><span class="s s-Atom">python</span> <span class="p">.</span><span class="nn">decode</span><span class="p">:</span><span class="s s-Atom">true</span><span class="p">}</span>
<span class="p">[</span><span class="s s-Atom">input</span><span class="p">]</span><span class="s s-Atom">:</span> <span class="s s-Atom">print</span> <span class="s s-Atom">l</span><span class="p">[</span><span class="s s-Atom">::-</span><span class="mi">1</span><span class="p">]</span>
<span class="p">[</span><span class="s s-Atom">output</span><span class="p">]</span><span class="s s-Atom">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>


<h2>Reversed method</h2>
<p>We use the
<strong><a href="https://docs.python.org/2/library/functions.html#reversed">reversed</a></strong> method
that returns an iterable object and a list comprehension to generate the
new list</p>
<p>``` {.lang:python .decode:true}
[input]: print [x for x in reversed(l)]
[output]: [6, 5, 4, 3, 2, 1]</p>
<div class="highlight"><pre><span></span><span class="gh">Swapping values in place</span>
<span class="gh">------------------------</span>

This last method is more verbose and it basically divides the list in
two parts and swaps the first with sixth, the second with fifth, etc...

<span class="s">``` {.lang:python .decode:true}</span>
<span class="s">[input]:</span>
<span class="s">for i in range(0, len(l) / 2):</span>
<span class="s">    l[i], l[len(l) -1 -i] = l[len(l) -1 -i], l[i]</span>
<span class="s">print l</span>

<span class="s">[output]: [6, 5, 4, 3, 2, 1]</span>
</pre></div>
                <a class="readmore" href="https://www.andreagrandi.it/2015/10/11/reversing-a-list-in-python/">read more</a>
<p><a href="https://www.andreagrandi.it/2015/10/11/reversing-a-list-in-python/#disqus_thread">comments</a></p>                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="https://www.andreagrandi.it/2015/08/31/understanding-python-decorators-optimizing-a-recursive-fibonacci-implementation/" rel="bookmark"
                           title="Permalink to Understanding Python decorators optimizing a recursive Fibonacci implementation">Understanding Python decorators optimizing a recursive Fibonacci implementation</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <span>Mon 31 August 2015</span>
	        <span>| in <a href="https://www.andreagrandi.it/category/programmazione-python.html">Programmazione, Python</a></span>
<span>| tags: <a href="https://www.andreagrandi.it/tag/decorators.html">decorators</a><a href="https://www.andreagrandi.it/tag/fibonacci.html">fibonacci</a><a href="https://www.andreagrandi.it/tag/memoization.html">memoization</a><a href="https://www.andreagrandi.it/tag/memoize.html">memoize</a><a href="https://www.andreagrandi.it/tag/optimization.html">optimization</a><a href="https://www.andreagrandi.it/tag/python.html">Python</a></span>
</footer><!-- /.post-info -->                <p>A <strong>decorator</strong> is a Python function that takes a <em>function object</em> as
an argument and returns a function as a <em>value</em>. Here is an example of
decorator definition:</p>
<p>``` {.lang:python .decode:true}
def foo(function):
    # make a new function
    def new_function():
        # some code</p>
<div class="highlight"><pre><span></span>return new_function
</pre></div>


<div class="highlight"><pre><span></span>To apply a decorator to an existing function, you just need to put
**@*decorator\_name*** in the line before its definition, like this
example:

``` {.lang:python .decode:true}
@foo
def hello():
    print &#39;Hello World&#39;
</pre></div>


<p>This decorator doesn't do anything, so let's think about a more concrete
problem we could solve using decorators.</p>
<h2>Fibonacci sequence</h2>
<p>By definition, the first two numbers in the
<strong><a href="https://en.wikipedia.org/wiki/Fibonacci_number">Fibonacci</a></strong> sequence
are either 1 and 1 or 0 and 1. All the other numbers are the sum of the
previous two numbers of the sequence. Example:</p>
<ol>
<li>0, 1: the third number is 1</li>
<li>0, 1, 1: the fourth number is 2</li>
<li>0, 1, 1, 2: the fifth number is 3</li>
<li>0, 1, 1, 2, 3: the sixth number is 5</li>
<li>etc...</li>
</ol>
<p>If we wanted to give a <strong>math definition</strong> of the sequence, we could
describe it in this way:</p>
<ul>
<li><strong>F(0): 0</strong></li>
<li><strong>F(1): 1</strong></li>
<li><strong>F(n): F(n-1) + F(n-2)</strong></li>
</ul>
<p>In <strong>Python</strong> we could have a <strong>recursive function</strong> like the following
one:</p>
<p>``` {.lang:python .decode:true}
def fib(n):
    if n &lt; 2:
        return n
    else:
        return fib(n-1) + fib(n-2)</p>
<div class="highlight"><pre><span></span>What&#39;s the problem with this implementation? The code works as expected,
but it&#39;s very **inefficient**. The next picture will explain what
happens when we will try, for example, to calculate the 5th number of
the sequence:

[![fibo](https://www.andreagrandi.it/wp-content/uploads/2015/08/fibo.png){.aligncenter
.size-full .wp-image-1036 width=&quot;617&quot;
height=&quot;359&quot;}](https://www.andreagrandi.it/wp-content/uploads/2015/08/fibo.png)

 

Fib(5) is Fib(4) + Fib(3), but Fib(4) itself is Fib(3) + Fib(2), and...
the picture just tell us that we have calculated Fib(3) 2 times, Fib(2)
3 times, Fib(1) 5 times! Why are we repeating the same operation every
time if we already calculated the result?

Memoization
-----------

&gt; In computing, **memoization** is an optimization technique used
&gt; primarily to speed up computer programs by storing the results of
&gt; expensive function calls and returning the cached result when the same
&gt; inputs occur again.

We need to store values of the sequence we have already calculated and
get them later when we need them. Let&#39;s implement a simple memoization
decorator:

``` {.lang:python .decode:true}
def memoize(function):
    cache = {}

    def decorated_function(*args):
        if args in cache:
            return cache[args]
        else:
            val = function(*args)
            cache[args] = val
            return val
    return decorated_function
</pre></div>


<p>The decorator defines a dict at the beginning that is used as a cache.
When we want to find the n number of the sequence, it first checks if
the value was already calculated and that value is returned instead of
being calculated again. If the value is not found, then the original
function is being called and then the value is store in the cache, then
returned to the caller.</p>
<h2>Using the memoize decorator</h2>
<p>How much this decorator can speed up our fib method? Let's try to
benchmark the execution using Python
<strong><a href="https://docs.python.org/2/library/timeit.html">timeit</a></strong> module.</p>
<p>``` {.lang:python .decode:true}</p>
<h1>First example, not using the memoize decorator</h1>
<p>import timeit</p>
<p>def fib(n):
    if n &lt; 2:
        return n
    else:
        return fib(n-1) + fib(n-2)</p>
<p>t1 = timeit.Timer("fib(35)", "from <strong>main</strong> import fib")
print t1.timeit(1)</p>
<div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">required</span> <span class="n">time</span> <span class="n">to</span> <span class="n">calculate</span> <span class="n">the</span> <span class="mi">35</span><span class="n">th</span> <span class="n">number</span> <span class="n">of</span> <span class="n">the</span> <span class="n">Fibonacci</span> <span class="n">sequence</span>
<span class="n">on</span> <span class="n">my</span> <span class="n">laptop</span> <span class="ow">is</span><span class="p">:</span><span class="err"> </span><span class="o">**</span><span class="mf">4.73480010033</span><span class="o">**</span>

<span class="sb">``</span><span class="err">`</span> <span class="p">{</span><span class="o">.</span><span class="n">lang</span><span class="p">:</span><span class="n">python</span> <span class="o">.</span><span class="n">decode</span><span class="p">:</span><span class="n">true</span><span class="p">}</span>
<span class="c1"># Second example, using the memoize decorator</span>

<span class="kn">import</span> <span class="nn">timeit</span>
<span class="kn">from</span> <span class="nn">memoize</span> <span class="kn">import</span> <span class="n">memoize</span>  <span class="c1"># For convenience I put my decorator</span>
                             <span class="c1"># in a module named memoize.py</span>

<span class="nd">@memoize</span>
<span class="k">def</span> <span class="nf">fib</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">n</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fib</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">fib</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>

<span class="n">t1</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="s2">&quot;fib(35)&quot;</span><span class="p">,</span> <span class="s2">&quot;from __main__ import fib&quot;</span><span class="p">)</span>
<span class="k">print</span> <span class="n">t1</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>


<p>The required time to calculate the 35th number of the Fibonacci sequence
on my laptop is: <strong>0.000133037567139</strong></p>
<p>Quite faster, don't you think? I will let you try how long does it take
to calculate the 60th number of the sequence with and without using the
decorator. <strong>Hint:</strong> grab a cup of coffee before beginning!</p>
                <a class="readmore" href="https://www.andreagrandi.it/2015/08/31/understanding-python-decorators-optimizing-a-recursive-fibonacci-implementation/">read more</a>
<p><a href="https://www.andreagrandi.it/2015/08/31/understanding-python-decorators-optimizing-a-recursive-fibonacci-implementation/#disqus_thread">comments</a></p>                </div><!-- /.entry-content -->
            </article></li>
            </ol><!-- /#posts-list -->
<p class="paginator">
        <a href="https://www.andreagrandi.it/tag/python2.html">&laquo;</a>
    Page 3 / 8
        <a href="https://www.andreagrandi.it/tag/python4.html">&raquo;</a>
</p>
            </section><!-- /#content -->
        <section id="extras" class="body">
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="https://twitter.com/andreagrandi">twitter</a></li>
                            <li><a href="https://github.com/andreagrandi">github</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <p>
                    Powered by <a href="http://getpelican.com/">Pelican</a>. Theme <a href="https://github.com/blueicefield/pelican-blueidea/">blueidea</a>, inspired by the default theme.
                    <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">
                        <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/80x15.png" />
                    </a>
                </p>
        </footer><!-- /#contentinfo -->

    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-2140684-3']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
<script type="text/javascript">
    var disqus_shortname = 'andrea-grandi-it';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>
</html>